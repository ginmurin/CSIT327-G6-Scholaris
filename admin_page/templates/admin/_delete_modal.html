<div id="deleteModal" class="modal-backdrop" style="display:none;">
  <div class="modal-card">
    <h3 class="modal-title">Delete account?</h3>
    <p class="modal-text">
      Are you sure you want to delete <span id="deleteUserName">this user</span>?
      This action cannot be undone.
    </p>

    <div class="modal-actions">
      <button id="cancelDelete" class="btn-light" type="button">Cancel</button>
      <button id="confirmDelete" class="btn-mini danger" type="button">Yes, Delete</button>
    </div>
  </div>
</div>

<script>
  (function(){
    const modal = document.getElementById("deleteModal");
    const cancelBtn = document.getElementById("cancelDelete");
    const confirmBtn = document.getElementById("confirmDelete");
    const nameSpan = document.getElementById("deleteUserName");

    let pendingForm = null;

    document.querySelectorAll(".delete-form button[type='submit']").forEach(btn => {
      btn.addEventListener("click", function(e){
        e.preventDefault();
        pendingForm = this.closest("form");

        const name = this.dataset.name || "this user";
        nameSpan.textContent = name;

        modal.style.display = "flex";
      });
    });

    cancelBtn.addEventListener("click", () => {
      modal.style.display = "none";
      pendingForm = null;
    });

    modal.addEventListener("click", (e) => {
      if(e.target === modal){
        modal.style.display = "none";
        pendingForm = null;
      }
    });

    confirmBtn.addEventListener("click", () => {
      if(pendingForm) pendingForm.submit();
    });
  })();
</script>
